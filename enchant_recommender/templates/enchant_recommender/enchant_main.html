<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“œ ì¸ì±ˆíŠ¸ ê²Œì‹œë¬¼ ë©”ì¸</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  {# Google Fonts: ë§ˆì¸í¬ë˜í”„íŠ¸ í°íŠ¸ê°€ ì—†ìœ¼ë¯€ë¡œ ê°€ë…ì„± ì¢‹ì€ noto sans krì„ ì‚¬ìš©í•˜ê³ , ë””ìì¸ì„ ë§ˆí¬ ìŠ¤íƒ€ì¼ë¡œ ëŒ€ì²´ #}
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">

  {# ğŸ’¡ ì»¤ìŠ¤í…€ í•„í„° ë¡œë“œ #}
  {% load custom_filters %}

  <style>
    :root {
      --mc-gray-dark: #363636;
      --mc-gray-medium: #585858;
      --mc-gray-light: #c6c6c6;
      --mc-background: #f0f0f0;
      --mc-border: #000;
    }
    body {
      background-color: var(--mc-background);
      font-family: 'Noto Sans KR', sans-serif;
    }
    .container {
      margin-top: 40px;
      margin-bottom: 40px;
    }
    .main-box {
      display: flex;
      gap: 20px;
    }

    /* Minecraft ìŠ¤íƒ€ì¼ ì¹´ë“œ/íŒ¨ë„ */
    .mc-panel {
      border: 2px solid var(--mc-border);
      box-shadow: 4px 4px 0 var(--mc-gray-medium);
      padding: 15px;
      margin-bottom: 15px;
      background-color: #fff; /* í°ìƒ‰ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ê¹”ë”í•¨ ê°•ì¡° */
    }
    .mc-header {
      background-color: var(--mc-gray-medium);
      color: white;
      padding: 8px 15px;
      border-bottom: 2px solid var(--mc-border);
      margin: -15px -15px 15px -15px;
      font-weight: bold;
      text-shadow: 1px 1px 0 var(--mc-gray-dark);
    }

    /* ë©”ë‰´ íŒ¨ë„ */
    .left-panel { flex: 1; }

    /* ê²Œì‹œë¬¼ ëª©ë¡ íŒ¨ë„ */
    .center-panel { flex: 2; }

    /* ë§Œë“¤ê¸° íŒ¨ë„ */
    .right-panel { flex: 1; }

    .post-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 10px;
      border-bottom: 1px solid var(--mc-gray-light);
      transition: background-color 0.2s;
    }
    .post-item:hover {
      background-color: #f7f7f7;
    }
    .post-title {
      font-weight: 700;
      font-size: 1.1em;
      color: #0d6efd;
      text-decoration: none;
    }
    .post-info {
      font-size: 0.85em;
      color: var(--mc-gray-medium);
      margin-top: 4px;
    }
    .like-btn {
      min-width: 50px;
    }
  </style>
</head>
<body>
<div class="container">
    <div class="main-box">

        <div class="left-panel">
            <div class="mc-panel">
                <div class="mc-header">ë©”ë‰´</div>
                <div class="d-grid gap-2">
                    <a href="/" class="btn btn-secondary btn-sm">ë©”ì¸ìœ¼ë¡œ</a>
                    <a href="{% url 'enchant_recommender:main' %}" class="btn btn-primary btn-sm">ğŸ“œ ì¸ì±ˆíŠ¸ ê²Œì‹œíŒ</a>
                    <a href="/potions/simulator/" class="btn btn-secondary btn-sm">ğŸ§ª ì–‘ì¡° ì‹œë®¬ë ˆì´í„°</a>
                    <a href="/wiki/challenge-info/" class="btn btn-secondary btn-sm">ğŸ† ë„ì „ê³¼ì œ</a>
                </div>
            </div>
        </div>

        <div class="center-panel">
            <div class="mc-panel">
                <div class="mc-header">ğŸ“œ ì¸ì±ˆíŠ¸ ì¶”ì²œ ê²Œì‹œë¬¼</div>

                {# Django messages ì¶œë ¥ #}
                {% if messages %}
                  {% for m in messages %}
                    <div class="alert alert-{{ m.tags }} alert-dismissible fade show mb-3" role="alert">
                      {{ m }}
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                  {% endfor %}
                {% endif %}

                {% if not allow_likes %}
                    <div class="alert alert-info mb-3" role="alert">
                        ì‹¤ì œ ê²Œì‹œë¬¼ì´ ì—†ì–´ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë³´ì—¬ì£¼ëŠ” ì¤‘ì…ë‹ˆë‹¤. ê²Œì‹œë¬¼ì„ ë“±ë¡í•˜ë©´ ìµœì‹  ê¸€ì´ ìë™ìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
                    </div>
                {% endif %}

                <div class="post-list">
                    {% if posts %}
                        {% for post in posts %}
                            {# ì¢‹ì•„ìš” í™•ì¸ ë¡œì§ #}
                            {% with is_liked=post.pk|in_list:liked_post_pks %}
                            <div class="post-item">
                                <div class="post-content">
                                    {# ì œëª© ì¶œë ¥ #}
                                    <a href="{% url 'enchant_recommender:detail' pk=post.pk %}" class="post-title">
                                        {{ post.title }}
                                    </a>
                                    <div class="post-info">
                                        ì‘ì„±ì: **{{ post.user.username }}** | {{ post.created_at|date:"Y.m.d H:i" }}
                                    </div>
                                </div>

                                {# ì¢‹ì•„ìš” í¼ #}
                                <form method="post" action="{% url 'enchant_recommender:like_post' %}" class="d-inline">
                                    {% csrf_token %}
                                    <input type="hidden" name="post_pk" value="{{ post.pk }}">
                                    <button type="submit" class="btn btn-sm like-btn {% if is_liked %}btn-warning{% else %}btn-outline-warning{% endif %}"
                                            {% if not user.is_authenticated or not allow_likes %}disabled title="{% if not allow_likes %}ìƒ˜í”Œ ë°ì´í„°ì—ì„œëŠ” ì¢‹ì•„ìš”ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.{% else %}ë¡œê·¸ì¸ í•„ìš”{% endif %}"{% endif %}>
                                        <span style="font-size: 0.9em;">ğŸ‘ {{ post.likes_count }}</span>
                                    </button>
                                </form>
                            </div>
                            {% endwith %}
                        {% endfor %}
                    {% else %}
                        <p class="text-muted p-3 m-0">ì‘ì„±ëœ ì¸ì±ˆíŠ¸ ì¶”ì²œ ê²Œì‹œë¬¼ì´ ì—†ìŠµë‹ˆë‹¤. ì§€ê¸ˆ ë°”ë¡œ ë§Œë“¤ì–´ë³´ì„¸ìš”!</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="right-panel">
            <div class="mc-panel text-center">
                <div class="mc-header">âœï¸ ìƒˆë¡œìš´ ì¶”ì²œ</div>
                <p class="text-muted">ë‚˜ë§Œì˜ ìµœì  ì¸ì±ˆíŠ¸ ì¡°í•©ì„ ê³µìœ í•´ ë³´ì„¸ìš”!</p>

                <a href="{% url 'enchant_recommender:new_recommender' %}" class="btn btn-success mt-2 w-100">
                    <i class="fas fa-magic"></i> ìƒˆ ì¸ì±ˆíŠ¸ ì‹œë®¬ë ˆì´í„°
                </a>

                <a href="{% url 'enchant_recommender:list' %}" class="btn btn-info btn-sm mt-3 w-100">
                    ì „ì²´ ëª©ë¡ ë³´ê¸°
                </a>
            </div>
        </div>

    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
